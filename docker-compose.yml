# ZMC Alarm Exporter - Docker Compose 配置
#
# 使用方法:
#   1. 复制 .env.example 为 .env 并配置
#   2. docker-compose up -d
#
# 生产环境部署:
#   1. 将 .env 和 docker-compose.yml 复制到服务器的 /opt/zmc-alarm-exporter/
#   2. cd /opt/zmc-alarm-exporter && docker-compose up -d
#

services:
  zmc-alarm-exporter:
    image: zmc-alarm-exporter:${VERSION:-latest}
    container_name: zmc-alarm-exporter
    restart: unless-stopped
    ports:
      - "8080:8080"
    volumes:
      # 配置文件挂载 (只读)
      - ./.env:/app/.env:ro
      # 日志目录持久化
      - ./logs:/app/logs
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health/live"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    logging:
      driver: "json-file"
      options:
        max-size: "50m"
        max-file: "3"
