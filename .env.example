# ZMC Alarm Exporter 环境变量配置示例
# 复制此文件为 .env 并修改配置值

# ========== 应用配置 ==========
DEBUG=false

# ========== Oracle 数据库配置 ==========
# ZMC Oracle 数据库连接信息
ZMC_ORACLE_HOST=10.101.1.42
ZMC_ORACLE_PORT=1522
ZMC_ORACLE_SERVICE_NAME=rb
ZMC_ORACLE_USERNAME=zmc
ZMC_ORACLE_PASSWORD=smart
ZMC_ORACLE_POOL_MIN=2
ZMC_ORACLE_POOL_MAX=10
ZMC_ORACLE_TIMEOUT=30
# Oracle Instant Client 库路径 (用于启用 thick 模式)
# 如果遇到 DPY-3015 密码验证器错误，需要设置此路径
# 程序会自动搜索常见路径，如果自动搜索失败，请手动指定
# ZMC_ORACLE_CLIENT_LIB_DIR=/soft/oracle/lib

# ========== Alertmanager 配置 ==========
ALERTMANAGER_URL=http://localhost:9093
ALERTMANAGER_API_VERSION=v2
ALERTMANAGER_AUTH_ENABLED=false
# ALERTMANAGER_USERNAME=admin
# ALERTMANAGER_PASSWORD=password
ALERTMANAGER_TIMEOUT=30
ALERTMANAGER_RETRY_COUNT=3
ALERTMANAGER_RETRY_INTERVAL=1000

# ========== OpsGenie 配置 (可选直连) ==========
OPSGENIE_ENABLED=false
OPSGENIE_API_URL=https://api.opsgenie.com
OPSGENIE_API_KEY=your-api-key-here
OPSGENIE_DEFAULT_TEAM=ops-team
OPSGENIE_REGION=US

# ========== 同步服务配置 ==========
SYNC_ENABLED=true
# 扫描间隔（秒）
SYNC_SCAN_INTERVAL=60
# 心跳间隔（秒）- 用于保持告警活跃
SYNC_HEARTBEAT_INTERVAL=120
# 批处理大小
SYNC_BATCH_SIZE=100
# 启动时同步历史告警
SYNC_SYNC_ON_STARTUP=true
# 历史回溯时长（小时）
SYNC_HISTORY_HOURS=24
# 工作线程数
SYNC_WORKER_THREADS=4

# 告警级别过滤
# ZMC告警级别: 1-严重, 2-重要, 3-次要, 4-警告
# 示例: "1,2" 表示只同步严重和重要级别的告警
# 示例: "1,2,3,4" 或留空表示同步所有级别
SYNC_ALARM_LEVELS=1,2,3,4

# Prometheus severity 过滤
# 示例: "critical,error" 表示只同步映射后为 critical 或 error 的告警
# 留空表示同步所有级别
SYNC_SEVERITY_FILTER=

# ========== 静默策略配置 ==========
# 使用 Alertmanager Silence API 处理屏蔽的告警
SILENCE_USE_SILENCE_API=true
# 默认静默时长（小时）
SILENCE_DEFAULT_DURATION_HOURS=24
# 告警清除时自动移除静默
SILENCE_AUTO_REMOVE_ON_CLEAR=true
# 静默注释模板
SILENCE_COMMENT_TEMPLATE="Silenced by ZMC at {time}. Operator: {operator}"

# ========== 告警级别映射 ==========
# ZMC 告警级别到 Prometheus severity 的映射
SEVERITY_LEVEL_0=warning
SEVERITY_LEVEL_1=critical
SEVERITY_LEVEL_2=error
SEVERITY_LEVEL_3=warning
SEVERITY_LEVEL_4=info

# ========== 状态映射 ==========
# ZMC 告警状态到同步状态的映射
STATUS_STATE_U=FIRING
STATUS_STATE_A=RESOLVED
STATUS_STATE_M=SILENCED
STATUS_STATE_C=RESOLVED

# ========== 静态标签配置 ==========
# 添加到所有 Prometheus 告警的标签
LABEL_SOURCE=zmc
# LABEL_CLUSTER=production
# LABEL_DATACENTER=dc1

# ========== 日志配置 ==========
LOG_LEVEL=INFO
# 日志格式: json 或 text
LOG_FORMAT=json
# 日志保留天数
LOG_RETENTION_DAYS=30
# 记录请求/响应体
LOG_REQUEST_BODY=true
LOG_RESPONSE_BODY=true

# ========== 服务器配置 ==========
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
SERVER_WORKERS=1
SERVER_RELOAD=false
